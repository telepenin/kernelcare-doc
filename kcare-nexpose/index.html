<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Kcare-nexpose | Documentation</title>
    <meta name="description" content="Kernelcare documentation">
    
    
    <link rel="preload" href="/assets/css/0.styles.8ca6b66c.css" as="style"><link rel="preload" href="/assets/js/app.bcc46952.js" as="script"><link rel="preload" href="/assets/js/14.348feee3.js" as="script"><link rel="prefetch" href="/assets/js/1.8353e851.js"><link rel="prefetch" href="/assets/js/10.a940ac69.js"><link rel="prefetch" href="/assets/js/11.d9febe8e.js"><link rel="prefetch" href="/assets/js/12.983230c7.js"><link rel="prefetch" href="/assets/js/13.cd26059b.js"><link rel="prefetch" href="/assets/js/15.ca99983e.js"><link rel="prefetch" href="/assets/js/16.657d8b7f.js"><link rel="prefetch" href="/assets/js/17.40792003.js"><link rel="prefetch" href="/assets/js/18.44423953.js"><link rel="prefetch" href="/assets/js/19.6ecccafe.js"><link rel="prefetch" href="/assets/js/2.78f29c86.js"><link rel="prefetch" href="/assets/js/20.a7ced964.js"><link rel="prefetch" href="/assets/js/21.aa9e39aa.js"><link rel="prefetch" href="/assets/js/22.abf3e90c.js"><link rel="prefetch" href="/assets/js/23.9d9d3823.js"><link rel="prefetch" href="/assets/js/24.6764129a.js"><link rel="prefetch" href="/assets/js/25.4d861c70.js"><link rel="prefetch" href="/assets/js/26.a3679a4d.js"><link rel="prefetch" href="/assets/js/27.4aefa8c5.js"><link rel="prefetch" href="/assets/js/28.485cf69a.js"><link rel="prefetch" href="/assets/js/29.50425836.js"><link rel="prefetch" href="/assets/js/30.ee4e9568.js"><link rel="prefetch" href="/assets/js/31.8b89124e.js"><link rel="prefetch" href="/assets/js/32.80f524d1.js"><link rel="prefetch" href="/assets/js/33.4f17a919.js"><link rel="prefetch" href="/assets/js/34.7b56bd5d.js"><link rel="prefetch" href="/assets/js/35.b4e0a3ab.js"><link rel="prefetch" href="/assets/js/36.5612976e.js"><link rel="prefetch" href="/assets/js/37.98a5f53f.js"><link rel="prefetch" href="/assets/js/38.b8b32cfd.js"><link rel="prefetch" href="/assets/js/39.7b868cda.js"><link rel="prefetch" href="/assets/js/40.5a94e4e7.js"><link rel="prefetch" href="/assets/js/41.2052311d.js"><link rel="prefetch" href="/assets/js/42.db099ae3.js"><link rel="prefetch" href="/assets/js/43.b19f8a61.js"><link rel="prefetch" href="/assets/js/44.77f56898.js"><link rel="prefetch" href="/assets/js/45.054e8dc3.js"><link rel="prefetch" href="/assets/js/5.21f72955.js"><link rel="prefetch" href="/assets/js/6.2a3a7c8f.js"><link rel="prefetch" href="/assets/js/7.212af394.js"><link rel="prefetch" href="/assets/js/8.6a40905c.js"><link rel="prefetch" href="/assets/js/9.e4334b9c.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.c6ce7e22.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8ca6b66c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/kc-logo.svg" alt="Documentation" class="logo"> <span class="site-name can-hide">Documentation</span></a> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value="Search"> <!----></div> <div class="links" style="max-width:nullpx;"><a href="https://cloudlinux.com/kernelcare-free-trial5" target="_blank" class="btn">
      Try Free
    </a> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/kcare-nexpose/" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/ru/kcare-nexpose/" class="nav-link">Русский</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/kcare-nexpose/" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/ru/kcare-nexpose/" class="nav-link">Русский</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Content</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/installation/" class="sidebar-link">Installation of KernelCare</a></li><li><a href="/settings/" class="sidebar-link">Basic Management</a></li><li><a href="/command_line/" class="sidebar-link">Command Line Tools</a></li><li><a href="/config_options/" class="sidebar-link">Config Options</a></li><li><a href="/disabling_some_patches/" class="sidebar-link">Disabling Some Patches</a></li><li><a href="/delayed_feed/" class="sidebar-link">Delayed Feed</a></li><li><a href="/extra_patchse/" class="sidebar-link">Extra Patchset</a></li><li><a href="/sticky_patches/" class="sidebar-link">Sticky Patches</a></li><li><a href="/nagios_plugin/" class="sidebar-link">Nagios Plugin</a></li><li><a href="/zabbix_template/" class="sidebar-link">Zabbix Template</a></li><li><a href="/upgrade/" class="sidebar-link">Upgrade</a></li><li><a href="/uninsta/" class="sidebar-link">Uninstall KernelCare</a></li><li><a href="/technology/" class="sidebar-link">Technology</a></li><li><a href="/reseller_partner_ui/" class="sidebar-link">Reseller Partner UI</a></li><li><a href="/kernelcare_enterprise/" class="sidebar-link">KernelCare.ePortal</a></li><li><a href="/kcare-nexpose/" class="active sidebar-link">Kcare-nexpose</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/kcare-nexpose/#installation" class="sidebar-link">Installation</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/kcare-nexpose/#from-yum-repository" class="sidebar-link">From yum repository</a></li><li class="sidebar-sub-header"><a href="/kcare-nexpose/#from-github" class="sidebar-link">From github</a></li></ul></li><li class="sidebar-sub-header"><a href="/kcare-nexpose/#how-it-works" class="sidebar-link">How It Works</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/kcare-nexpose/#supported-report-types" class="sidebar-link">Supported report types</a></li></ul></li><li class="sidebar-sub-header"><a href="/kcare-nexpose/#how-to-launch" class="sidebar-link">How To Launch</a></li><li class="sidebar-sub-header"><a href="/kcare-nexpose/#yaml-config-file-description" class="sidebar-link">YAML config file description</a></li></ul></li><li><a href="/kernelcare_whmcs_plugin/" class="sidebar-link">KernelCare WHMCS Plugin</a></li><li><a href="/proxy_settings/" class="sidebar-link">Firewall and Proxy Settings</a></li><li><a href="/eol_ubuntu_lts_kernels_suppor/" class="sidebar-link">EOL Ubuntu LTS kernels support</a></li><li><a href="/downloading_documentation/" class="sidebar-link">Downloading Documentation</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="kcare-nexpose"><a href="#kcare-nexpose" aria-hidden="true" class="header-anchor">#</a> Kcare-nexpose</h1> <p>The script marks vulnerabilities detected by Nexpose, but patched by KernelCare as exceptions.</p> <h2 id="installation"><a href="#installation" aria-hidden="true" class="header-anchor">#</a> Installation</h2> <h3 id="from-yum-repository"><a href="#from-yum-repository" aria-hidden="true" class="header-anchor">#</a> From yum repository</h3> <p>To install kcare-nexpose, start with the minimal image of EL6:</p> <div class="language- extra-class"><pre class="language-text"><code>$ cat &gt; /etc/yum.repos.d/kcare-eportal.repo &lt;&lt;EOL
[kcare-eportal]
name=kcare-eportal
baseurl=http://repo.eportal.kernelcare.com/x86_64/
gpgkey=http://repo.cloudlinux.com/kernelcare-debian/6/conf/kcaredsa_pub.gpg
enabled=1
gpgcheck=1
EOL
</code></pre></div><p>To install kcare-nexpose run the command:</p> <div class="language- extra-class"><pre class="language-text"><code>$ yum install kcare-nexpose
</code></pre></div><p></p> <h3 id="from-github"><a href="#from-github" aria-hidden="true" class="header-anchor">#</a> From github</h3> <p></p> <div class="language- extra-class"><pre class="language-text"><code>$ git clone https://github.com/cloudlinux/kcare-nexpose.git
$ cd kcare-nexpose/
$ python setup.py install
$ pip install -r REQUIREMENTS
</code></pre></div><h2 id="how-it-works"><a href="#how-it-works" aria-hidden="true" class="header-anchor">#</a> How It Works</h2> <p>The script finds CVEs that are related to patches applied by KernelCare (downloaded either from KernelCare ePortal or the central KernelCare patch server) and excludes them from Nexpose vulnerability scanner reports. The script can approve this exception in Nexpose (if you do not want to approve, set <code>is_approve</code> to <code>false</code> in the script config). It can also remove the old exceptions left from the previous script runs (set <code>delete_old</code> to <code>true</code> in the script config).</p> <p>First, you should generate report in Nexpose (see supported report types below) and specify it in the config file. Also you need to specify some other <a href="/kcare-nexpose#yaml-config-file-description/">parameters</a> :</p> <div class="language- extra-class"><pre class="language-text"><code>$ cp /usr/local/etc/kcare-nexpose.yml.template /usr/local/etc/kcare-nexpose.yml
$ vim /usr/local/etc/kcare-nexpose.yml
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">Note</p> <p>IP address in Nexpose and the one in KernelCare ePortal should be the same. If you use Nexpose and KernelCare ePortal on different instances, you should make sure that Nexpose and KernelCare ePortal are not using localhost (127.0.0.1). Otherwise, kcare-nexpose can mark vulnerability wrong, as it just analyzes IP addresses from Nexpose and KernelCare ePortal.
<em>If used with CLN license server, the script can work with servers behind NAT by matching them by their hostnames.</em></p></div> <h3 id="supported-report-types"><a href="#supported-report-types" aria-hidden="true" class="header-anchor">#</a> Supported report types</h3> <p><em>raw-xml-v2</em></p> <p><img src="https://docs.kernelcare.com/nexpose-xml2_zoom70.png" alt></p> <h2 id="how-to-launch"><a href="#how-to-launch" aria-hidden="true" class="header-anchor">#</a> How To Launch</h2> <p>To launch kcare-nexpose run:</p> <div class="language- extra-class"><pre class="language-text"><code>$ kcare-nexpose -c /usr/local/etc/kcare-nexpose.yml
</code></pre></div><h2 id="yaml-config-file-description"><a href="#yaml-config-file-description" aria-hidden="true" class="header-anchor">#</a> YAML config file description</h2> <div class="language- extra-class"><pre class="language-text"><code># Nexpose section

nexpose:
 # Host to connect with Nexpose Security Console

  host: 192.168.100.100

  # Port to connect with Nexpose Security Console
  port: 3780

  # Username to auth with Nexpose Security Console
  username: admin

  # Password to auth with Nexpose Security Console
  password: hup^r37kZc72MjY}=ox?WTQ

  # Report name which will be analyzed for look up related CVE with kernelcare ePortal
  report-name: kernelcare

  # Change this to 'true' if you want the script to automatically mark 
  # vulnerabilities as exceptions, so they don't show up in the report
  is_approve: true

  # If you want to delete old exceptions. If it is false, old exceptions will not be deleted
  delete_old: true

  format: raw-xml-v2

# License and patch server section
patch-server:

  # URL to connect to Kernelcare ePortal

  # For kernelcare ePortal use &quot;http://&lt;kernel-care-eportal-domain-name-or-ip&gt;/admin/api/kcare/patchset/&quot;
  # For licenses issued by CLN, use &quot;https://cln.cloudlinux.com/api/kcare/patchset.json?key=&quot;
  server: https://cln.cloudlinux.com/api/kcare/patchset.json?key=

  # Server for patch sets
  # For patch sets from Kernelcare ePortal server use domain name
  # (or IP address)
  # patches-info: http://&lt;kernel-care-eportal-domain-name-or-ip&gt;

  # For patch sets from the central KernelCare patch server
  patches-info: http://patches.kernelcare.com/

  # List of KernelCare license keys
  keys:
    - 0G0996952sTtCU4z
    - hx5LO1n49zY5jp6B
</code></pre></div></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/kernelcare_enterprise/" class="prev">
          KernelCare.ePortal
        </a></span> <span class="next"><a href="/kernelcare_whmcs_plugin/">
          KernelCare WHMCS Plugin
        </a>
        →
      </span></p></div> </div> <div class="footer" data-v-675e349c><div data-v-675e349c><a href="https://cloudlinux.com" data-v-675e349c><img src="/we-are-cloudlinux.svg" alt="We are Cloudlinux" data-v-675e349c></a></div> <div data-v-675e349c>2018. CloudLinux Inc</div> <div data-v-675e349c><div data-v-675e349c><a href="#" target="_blank" data-v-675e349c>How to</a></div><div data-v-675e349c><a href="#" target="_blank" data-v-675e349c>Getting started</a></div><div data-v-675e349c><a href="https://cloudlinux.zendesk.com/hc/en-us/requests/new" target="_blank" data-v-675e349c>Contact support</a></div><div data-v-675e349c><a href="https://www.cloudlinux.com/kernelcare-blog" target="_blank" data-v-675e349c>Blog</a></div></div> <div class="social" data-v-675e349c><span data-v-675e349c>Stay in touch</span> <a href="https://www.facebook.com/kernelcare/" target="_blank" data-v-675e349c><img src="/fb.svg" data-v-675e349c></a><a href="https://twitter.com/kernelcare" target="_blank" data-v-675e349c><img src="/tw.svg" data-v-675e349c></a><a href="https://linkedin.com/company/cloudlinux" target="_blank" data-v-675e349c><img src="/in.svg" data-v-675e349c></a><a href="https://www.youtube.com/channel/UCZ3YMHWnMP7TaxlXVay5-aw" target="_blank" data-v-675e349c><img src="/ytube.svg" data-v-675e349c></a></div></div> <!----></div></div>
    <script src="/assets/js/14.348feee3.js" defer></script><script src="/assets/js/app.bcc46952.js" defer></script>
  </body>
</html>
